<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Stellar Predictor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div id="app">
    <header>
      <h1>Stellar Multi‑Modal Predictor</h1>
      <p class="subtitle">Interact with spectral & light curve models (calibrated)</p>
    </header>

    <section class="panel" id="connection-panel">
      <h2>API Connection</h2>
      <label>API Base URL <input id="apiBase" value="http://localhost:8000" /></label>
      <label>API Key (optional) <input id="apiKey" type="password" placeholder="x-api-key" /></label>
      <button id="btnCheck">Check Health</button>
      <pre id="healthOutput" class="output"></pre>
    </section>

    <section class="panel">
      <h2>Spectral Prediction</h2>
      <textarea id="spectralInput" placeholder="Enter one spectrum per line; comma or space separated values">
0.1,0.2,0.3,0.4,0.5
0.05 0.1 0.15 0.2 0.25
      </textarea>
      <div class="row">
        <label><input type="checkbox" id="spectralCalib" /> Apply Calibration</label>
        <label>Top-K <input type="number" id="spectralTopK" min="1" max="10" value="3" /></label>
      </div>
      <button id="btnPredictSpectral">Predict Spectra</button>
      <pre id="spectralOutput" class="output"></pre>
    </section>

    <section class="panel">
      <h2>Light Curve Prediction</h2>
      <textarea id="lcInput" placeholder="Enter one light curve per line; comma or space separated values">
1,1.01,0.99,1.02,0.98,1.0
0.9 1.0 1.1 1.0 0.95 1.05
      </textarea>
      <div class="row">
        <label><input type="checkbox" id="lcCalib" /> Apply Calibration</label>
        <label>Top-K <input type="number" id="lcTopK" min="1" max="10" value="3" /></label>
      </div>
      <button id="btnPredictLC">Predict Light Curves</button>
      <pre id="lcOutput" class="output"></pre>
    </section>

    <section class="panel" id="data-sync">
      <h2>Data Sync</h2>
      <div class="row">
        <h3>Spectra (SDSS)</h3>
      </div>
      <div class="row">
        <label>Max Records <input type="number" id="syncSpecMax" value="100" min="1" /></label>
        <label>Min S/N <input type="number" id="syncSpecSN" value="5" step="0.1" /></label>
        <label>Batch Size <input type="number" id="syncSpecBatch" value="100" min="1" /></label>
        <label><input type="checkbox" id="syncSpecResume" checked /> Resume</label>
        <button id="btnSyncSpectra">Sync Spectra</button>
      </div>
      <pre id="syncSpectraOutput" class="output"></pre>

      <div class="row">
        <h3>Lightcurves (TESS/Kepler)</h3>
      </div>
      <div class="row">
        <label>Mission
          <select id="syncLcMission">
            <option value="TESS" selected>TESS</option>
            <option value="Kepler">Kepler</option>
          </select>
        </label>
        <label>Max Records <input type="number" id="syncLcMax" value="100" min="1" /></label>
        <label><input type="checkbox" id="syncLcResume" checked /> Resume</label>
        <button id="btnSyncLightcurves">Sync Lightcurves</button>
      </div>
      <pre id="syncLightcurvesOutput" class="output"></pre>
    </section>

    <section class="panel" id="preprocess-spectral">
      <h2>Preprocess Spectral</h2>
      <textarea id="preSpecWavelength" placeholder="Wavelengths (Angstrom), comma/space separated">3500 3600 3700 3800 3900</textarea>
      <textarea id="preSpecFlux" placeholder="Flux values (Jy), comma/space separated">1.0 1.1 0.95 1.05 0.98</textarea>
      <div class="row">
        <label><input type="checkbox" id="preSpecContinuum" checked /> Continuum Normalize</label>
        <label>Method
          <select id="preSpecMethod">
            <option value="spline" selected>spline</option>
            <option value="polynomial">polynomial</option>
            <option value="median">median</option>
          </select>
        </label>
        <label><input type="checkbox" id="preSpecAirVac" /> Convert Air→Vacuum</label>
        <label><input type="checkbox" id="preSpecTelluric" /> Mask Telluric</label>
        <label>Redshift <input type="number" id="preSpecRedshift" step="0.001" placeholder="optional" /></label>
      </div>
      <button id="btnPreprocessSpectral">Run Spectral Preprocessing</button>
      <pre id="preSpecOutput" class="output"></pre>
    </section>

    <section class="panel" id="preprocess-lightcurve">
      <h2>Preprocess Lightcurve</h2>
      <textarea id="preLcTime" placeholder="Time (JD), comma/space separated">2457000 2457001 2457002 2457003 2457004</textarea>
      <textarea id="preLcFlux" placeholder="Flux, comma/space separated">1.0 1.02 0.99 1.01 1.0</textarea>
      <div class="row">
        <label><input type="checkbox" id="preLcDetrend" checked /> Detrend</label>
        <label>Method
          <select id="preLcDetrendMethod">
            <option value="polynomial" selected>polynomial</option>
            <option value="spline">spline</option>
            <option value="savgol">savgol</option>
          </select>
        </label>
        <label><input type="checkbox" id="preLcOutliers" checked /> Remove Outliers</label>
        <label>Sigma <input type="number" id="preLcSigma" value="5" step="0.1" /></label>
        <label><input type="checkbox" id="preLcFillGaps" /> Fill Gaps</label>
        <label>Interpolation
          <select id="preLcInterp">
            <option value="linear" selected>linear</option>
            <option value="cubic">cubic</option>
            <option value="spline">spline</option>
          </select>
        </label>
        <label><input type="checkbox" id="preLcFindPeriod" /> Find Period</label>
      </div>
      <button id="btnPreprocessLightcurve">Run Lightcurve Preprocessing</button>
      <pre id="preLcOutput" class="output"></pre>
    </section>

    <section class="panel" id="data-loaders">
      <h2>Data Loaders (Batch)</h2>
      <div class="row">
        <label>Type
          <select id="loaderType">
            <option value="spectral" selected>spectral</option>
            <option value="lightcurve">lightcurve</option>
          </select>
        </label>
        <label>Num Samples <input type="number" id="loaderNum" value="16" min="1" /></label>
        <label>Batch Size <input type="number" id="loaderBatch" value="16" min="1" /></label>
        <label><input type="checkbox" id="loaderAug" /> Apply Augmentation</label>
        <button id="btnGetBatch">Get Batch</button>
      </div>
      <pre id="loaderOutput" class="output"></pre>
    </section>

    <section class="panel">
      <h2>Model Metadata</h2>
      <div class="row">
        <input id="metaFamily" placeholder="spectral_cnn" value="spectral_cnn" />
        <button id="btnMeta">Fetch Metadata</button>
      </div>
      <pre id="metaOutput" class="output"></pre>
    </section>

    <footer>
      <small>Stellar Platform Demo UI · Generated {{DATE}}</small>
    </footer>
  </div>
  <script src="app.js"></script>
</body>
</html>
